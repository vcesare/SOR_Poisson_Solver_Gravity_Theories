# SOR_Poisson_Solver_Gravity_Theories
SOR Poisson solver in 3D cylindrical coordinates in different gravity theories

This repository contains:
1) Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc

A C++ code that finds the Newtonian gravitational potential, φN, given a mass density distribution rho, by numerically solving Newtonian Poisson Equation (∇2φN = 4πGρ; e.g., Eq. (3) in Cesare, et al. (2020) (https://ui.adsabs.harvard.edu/abs/2020A%26A...637A..70C/abstract) over a 3D grid in cylindrical coordinates, (R,z,phi), with Successive-Over-Relaxation (SOR) Poisson Solver. This Poisson Solver is a 3D extension of 2D Poisson Solver described in Appendix B of Cesare, et al. (2020).

2) QUMOND_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc

A C++ code that finds the QUMOND gravitational potential, φQM, given a Newtonian potential generated by a mass density distribution rho, by numerically solving QUMOND Poisson Equation (∇2φQM = ∇·[ν(|∇φN|/a0)∇φN]; Milgrom, et al. (2010) (https://ui.adsabs.harvard.edu/abs/2010MNRAS.403..886M/abstract); e.g., Eq. (16) in Cesare, et al. (2020) (https://ui.adsabs.harvard.edu/abs/2020A%26A...637A..70C/abstract) over a 3D grid in cylindrical coordinates, (R,z,phi), with Successive-Over-Relaxation (SOR) Poisson Solver. This Poisson Solver is a 3D extension of 2D Poisson Solver described in Appendix B of Cesare, et al. (2020).

3) Plots_1D_phiNTheo_vs_phiNComp.py

A Python code to plot the 1D analytical vs numerical Newtonian potential along R, z, and phi dimensions of the 3D computational grid, from the outputs of Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc code.

4) Plots_1D_phiNTheo_vs_phiNComp.pdf

The resulting plots from Plots_1D_phiNTheo_vs_phiNComp.py.

5) Phi_Ratio.nb

The ratios between the numerical and the analytical Newtonian potentials plotted in Plots_1D_phiNTheo_vs_phiNComp.pdf along R, z, and phi dimensions of the 3D computational grid (they are ~1 along the three dimensions).

6) Plots_1D_phiNComp_vs_phiQUMONDComp.py

A Python code to plot the 1D numerical Newton vs QUMOND potential along R, z, and phi dimensions of the 3D computational grid, from the outputs of Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc and QUMOND_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc codes.

7) Plots_1D_phiNComp_vs_phiQUMONDComp.pdf

The resulting plots from Plots_1D_phiNComp_vs_phiQUMONDComp.py.

8) LICENSE

The file containing the MIT license of this GitHub project.


USER MANUAL:

git clone https://github.com/vcesare/SOR_Poisson_Solver_Gravity_Theories.git

Newtonian and QUMOND potentials generated by these two Poisson solvers are generated by an axisymmetric + spiral arms mass density distribution, where the axisymmetric mass density distribution is given by a Miyamoto-Nagai disk (Miyamoto & Nagai, 1975; https://ui.adsabs.harvard.edu/abs/1975PASJ...27..533M/abstract) and the spiral arms mass density distribution is given by Cox & Gomez (2002) model (https://ui.adsabs.harvard.edu/abs/2002ApJS..142..261C/abstract) with 3 arms in the spiral pattern.

Given that Newtonian potential from this mass density distribution is analytically derivable, Newtonian Poisson solver does not necessarily have to be executed. Numerical Newtonian potential is only computed to validate Newtonian Poisson solver by the comparison with analytical Newtonian Poisson solver. It is sufficient to uncomment the "exit(0);" instruction indicated in Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc to write to file the full 3D Newtonian analytical potential. The source term of QUMOND Poisson equation is computed from Newtonian potential. Therefore, the full 3D Newtonian potential (either analytical or numerical) has to be generated as input of QUMOND Poisson solver. These two Poisson solvers can be extened to other mass density distribution. If a density distribution from which the Newtonian potential cannot be analytically calculated is chosen, Newtonian and QUMOND Poisson solvers have necessarily to be executed in sequence.


# Compilation and execution of Newtonian Poisson solver:
g++ Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc -o Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model
./Newton_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model

# Compilation and execution of QUMOND Poisson solver:
g++ QUMOND_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model.cc -o QUMOND_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model
./QUMOND_Axisymmetric_MN_Disk_Plus_Spiral_Arms_Model
